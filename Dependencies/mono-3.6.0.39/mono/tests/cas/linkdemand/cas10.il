// original source is cas10.cs modified to use JMP

.assembly 'cas10'
{
	.permissionset reqrefuse = (
	3C 00 50 00 65 00 72 00 6D 00 69 00 73 00 73 00	 // <.P.e.r.m.i.s.s.
	69 00 6F 00 6E 00 53 00 65 00 74 00 20 00 63 00	 // i.o.n.S.e.t. .c.
	6C 00 61 00 73 00 73 00 3D 00 22 00 53 00 79 00	 // l.a.s.s.=.".S.y.
	73 00 74 00 65 00 6D 00 2E 00 53 00 65 00 63 00	 // s.t.e.m...S.e.c.
	75 00 72 00 69 00 74 00 79 00 2E 00 50 00 65 00	 // u.r.i.t.y...P.e.
	72 00 6D 00 69 00 73 00 73 00 69 00 6F 00 6E 00	 // r.m.i.s.s.i.o.n.
	53 00 65 00 74 00 22 00 0A 00 20 00 20 00 20 00	 // S.e.t."... . . .
	20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
	20 00 20 00 20 00 20 00 76 00 65 00 72 00 73 00	 // . . . .v.e.r.s.
	69 00 6F 00 6E 00 3D 00 22 00 31 00 22 00 3E 00	 // i.o.n.=.".1.".>.
	0A 00 20 00 20 00 20 00 3C 00 49 00 50 00 65 00	 // .. . . .<.I.P.e.
	72 00 6D 00 69 00 73 00 73 00 69 00 6F 00 6E 00	 // r.m.i.s.s.i.o.n.
	20 00 63 00 6C 00 61 00 73 00 73 00 3D 00 22 00	 // .c.l.a.s.s.=.".
	53 00 79 00 73 00 74 00 65 00 6D 00 2E 00 53 00	 // S.y.s.t.e.m...S.
	65 00 63 00 75 00 72 00 69 00 74 00 79 00 2E 00	 // e.c.u.r.i.t.y...
	50 00 65 00 72 00 6D 00 69 00 73 00 73 00 69 00	 // P.e.r.m.i.s.s.i.
	6F 00 6E 00 73 00 2E 00 53 00 65 00 63 00 75 00	 // o.n.s...S.e.c.u.
	72 00 69 00 74 00 79 00 50 00 65 00 72 00 6D 00	 // r.i.t.y.P.e.r.m.
	69 00 73 00 73 00 69 00 6F 00 6E 00 2C 00 20 00	 // i.s.s.i.o.n.,. .
	6D 00 73 00 63 00 6F 00 72 00 6C 00 69 00 62 00	 // m.s.c.o.r.l.i.b.
	2C 00 20 00 56 00 65 00 72 00 73 00 69 00 6F 00	 // ,. .V.e.r.s.i.o.
	6E 00 3D 00 31 00 2E 00 30 00 2E 00 35 00 30 00	 // n.=.1...0...5.0.
	30 00 30 00 2E 00 30 00 2C 00 20 00 43 00 75 00	 // 0.0...0.,. .C.u.
	6C 00 74 00 75 00 72 00 65 00 3D 00 6E 00 65 00	 // l.t.u.r.e.=.n.e.
	75 00 74 00 72 00 61 00 6C 00 2C 00 20 00 50 00	 // u.t.r.a.l.,. .P.
	75 00 62 00 6C 00 69 00 63 00 4B 00 65 00 79 00	 // u.b.l.i.c.K.e.y.
	54 00 6F 00 6B 00 65 00 6E 00 3D 00 62 00 37 00	 // T.o.k.e.n.=.b.7.
	37 00 61 00 35 00 63 00 35 00 36 00 31 00 39 00	 // 7.a.5.c.5.6.1.9.
	33 00 34 00 65 00 30 00 38 00 39 00 22 00 0A 00	 // 3.4.e.0.8.9."...
	20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
	20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
	76 00 65 00 72 00 73 00 69 00 6F 00 6E 00 3D 00	 // v.e.r.s.i.o.n.=.
	22 00 31 00 22 00 0A 00 20 00 20 00 20 00 20 00	 // ".1."... . . . .
	20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
	20 00 20 00 20 00 20 00 46 00 6C 00 61 00 67 00	 // . . . .F.l.a.g.
	73 00 3D 00 22 00 43 00 6F 00 6E 00 74 00 72 00	 // s.=.".C.o.n.t.r.
	6F 00 6C 00 50 00 72 00 69 00 6E 00 63 00 69 00	 // o.l.P.r.i.n.c.i.
	70 00 61 00 6C 00 22 00 2F 00 3E 00 0A 00 3C 00	 // p.a.l."./.>...<.
	2F 00 50 00 65 00 72 00 6D 00 69 00 73 00 73 00	 // /.P.e.r.m.i.s.s.
	69 00 6F 00 6E 00 53 00 65 00 74 00 3E 00 0A 00) // i.o.n.S.e.t.>...
}

.class public auto ansi beforefieldinit Program extends [mscorlib]System.Object
{
	.method public static hidebysig default int32 InnerTest (int32 rc) cil managed 
	{
		.permissionset linkcheck = (
			3C 00 50 00 65 00 72 00 6D 00 69 00 73 00 73 00	 // <.P.e.r.m.i.s.s.
			69 00 6F 00 6E 00 53 00 65 00 74 00 20 00 63 00	 // i.o.n.S.e.t. .c.
			6C 00 61 00 73 00 73 00 3D 00 22 00 53 00 79 00	 // l.a.s.s.=.".S.y.
			73 00 74 00 65 00 6D 00 2E 00 53 00 65 00 63 00	 // s.t.e.m...S.e.c.
			75 00 72 00 69 00 74 00 79 00 2E 00 50 00 65 00	 // u.r.i.t.y...P.e.
			72 00 6D 00 69 00 73 00 73 00 69 00 6F 00 6E 00	 // r.m.i.s.s.i.o.n.
			53 00 65 00 74 00 22 00 0A 00 20 00 20 00 20 00	 // S.e.t."... . . .
			20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
			20 00 20 00 20 00 20 00 76 00 65 00 72 00 73 00	 // . . . .v.e.r.s.
			69 00 6F 00 6E 00 3D 00 22 00 31 00 22 00 3E 00	 // i.o.n.=.".1.".>.
			0A 00 20 00 20 00 20 00 3C 00 49 00 50 00 65 00	 // .. . . .<.I.P.e.
			72 00 6D 00 69 00 73 00 73 00 69 00 6F 00 6E 00	 // r.m.i.s.s.i.o.n.
			20 00 63 00 6C 00 61 00 73 00 73 00 3D 00 22 00	 // .c.l.a.s.s.=.".
			53 00 79 00 73 00 74 00 65 00 6D 00 2E 00 53 00	 // S.y.s.t.e.m...S.
			65 00 63 00 75 00 72 00 69 00 74 00 79 00 2E 00	 // e.c.u.r.i.t.y...
			50 00 65 00 72 00 6D 00 69 00 73 00 73 00 69 00	 // P.e.r.m.i.s.s.i.
			6F 00 6E 00 73 00 2E 00 53 00 65 00 63 00 75 00	 // o.n.s...S.e.c.u.
			72 00 69 00 74 00 79 00 50 00 65 00 72 00 6D 00	 // r.i.t.y.P.e.r.m.
			69 00 73 00 73 00 69 00 6F 00 6E 00 2C 00 20 00	 // i.s.s.i.o.n.,. .
			6D 00 73 00 63 00 6F 00 72 00 6C 00 69 00 62 00	 // m.s.c.o.r.l.i.b.
			2C 00 20 00 56 00 65 00 72 00 73 00 69 00 6F 00	 // ,. .V.e.r.s.i.o.
			6E 00 3D 00 31 00 2E 00 30 00 2E 00 35 00 30 00	 // n.=.1...0...5.0.
			30 00 30 00 2E 00 30 00 2C 00 20 00 43 00 75 00	 // 0.0...0.,. .C.u.
			6C 00 74 00 75 00 72 00 65 00 3D 00 6E 00 65 00	 // l.t.u.r.e.=.n.e.
			75 00 74 00 72 00 61 00 6C 00 2C 00 20 00 50 00	 // u.t.r.a.l.,. .P.
			75 00 62 00 6C 00 69 00 63 00 4B 00 65 00 79 00	 // u.b.l.i.c.K.e.y.
			54 00 6F 00 6B 00 65 00 6E 00 3D 00 62 00 37 00	 // T.o.k.e.n.=.b.7.
			37 00 61 00 35 00 63 00 35 00 36 00 31 00 39 00	 // 7.a.5.c.5.6.1.9.
			33 00 34 00 65 00 30 00 38 00 39 00 22 00 0A 00	 // 3.4.e.0.8.9."...
			20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
			20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
			76 00 65 00 72 00 73 00 69 00 6F 00 6E 00 3D 00	 // v.e.r.s.i.o.n.=.
			22 00 31 00 22 00 0A 00 20 00 20 00 20 00 20 00	 // ".1."... . . . .
			20 00 20 00 20 00 20 00 20 00 20 00 20 00 20 00	 // . . . . . . . .
			20 00 20 00 20 00 20 00 46 00 6C 00 61 00 67 00	 // . . . .F.l.a.g.
			73 00 3D 00 22 00 43 00 6F 00 6E 00 74 00 72 00	 // s.=.".C.o.n.t.r.
			6F 00 6C 00 50 00 72 00 69 00 6E 00 63 00 69 00	 // o.l.P.r.i.n.c.i.
			70 00 61 00 6C 00 22 00 2F 00 3E 00 0A 00 3C 00	 // p.a.l."./.>...<.
			2F 00 50 00 65 00 72 00 6D 00 69 00 73 00 73 00	 // /.P.e.r.m.i.s.s.
			69 00 6F 00 6E 00 53 00 65 00 74 00 3E 00 0A 00) // i.o.n.S.e.t.>...
		.maxstack 8
		ldstr "*1* Library call expected to fail!"
		call void class [mscorlib]System.Console::WriteLine(string)
		ldarg.0 
		ret 
	}

	.method private static hidebysig default int32 Test (int32 rc) cil managed 
	{
		.maxstack 8
		jmp int32 class Program::InnerTest(int32)
	}

	.method private static hidebysig default int32 Main () cil managed 
	{
		.entrypoint
		.maxstack 3
		.locals init (
			class [mscorlib]System.Security.SecurityException V_0,
			class [mscorlib]System.Exception V_1,
			int32 V_2)

		.try {
			.try {
				ldc.i4.1 
				call int32 class Program::Test(int32)
				stloc.2 
				leave BYEBYE
			}
			catch [mscorlib]System.Security.SecurityException {
				stloc.0 
				ldstr "*0* Expected SecurityException\n{0}"
				ldloc.0 
				call void class [mscorlib]System.Console::WriteLine(string, object)
				ldc.i4.0 
				stloc.2 
				leave BYEBYE
			}
			catch [mscorlib]System.Exception {
				stloc.1 
				ldstr "*2* Unexpected Exception\n{0}"
				ldloc.1 
				call void class [mscorlib]System.Console::WriteLine(string, object)
				ldc.i4.2 
				stloc.2 
				leave BYEBYE
			}
		}
		finally	{
			endfinally 
		}

BYEBYE:		ldloc.2 
		ret 
	}
}
